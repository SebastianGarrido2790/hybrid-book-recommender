schema: '2.0'
stages:
  data_ingestion:
    cmd: python -m src.pipeline.stage_01_ingestion
    deps:
    - path: config/config.yaml
      hash: md5
      md5: 0291562b035d13af886220135ad47da4
      size: 1149
    - path: src/pipeline/stage_01_ingestion.py
      hash: md5
      md5: d6687ecd67640c1c4aad875e8ed969f7
      size: 1668
    outs:
    - path: artifacts/data_ingestion/books.csv
      hash: md5
      md5: fb986e694176649505eec4a383b8a3eb
      size: 4142211
  data_transformation:
    cmd: python -m src.pipeline.stage_03_transformation
    deps:
    - path: artifacts/data_validation/clean_books.csv
      hash: md5
      md5: 347fb6fccc65741c133914afb6cdcf1c
      size: 4134467
    - path: src/pipeline/stage_03_transformation.py
      hash: md5
      md5: 56231ddde3847fa176330bf0ce5a74ed
      size: 1756
    params:
      config/params.yaml:
        data_transformation.random_state: 42
        data_transformation.test_size: 0.3
        data_transformation.val_size: 0.5
    outs:
    - path: artifacts/data_transformation
      hash: md5
      md5: 98e44a13a1f2caff40aa29164e5914e3.dir
      size: 4134411
      nfiles: 3
  data_validation:
    cmd: python -m src.pipeline.stage_02_validation
    deps:
    - path: artifacts/data_ingestion/books.csv
      hash: md5
      md5: fb986e694176649505eec4a383b8a3eb
      size: 4142211
    - path: src/pipeline/stage_02_validation.py
      hash: md5
      md5: e11562436e1b58b9695d0c92d9d9777d
      size: 1704
    params:
      config/params.yaml:
        data_validation.categories_min_len: 2
        data_validation.min_desc_len: 20
    outs:
    - path: artifacts/data_validation/clean_books.csv
      hash: md5
      md5: 347fb6fccc65741c133914afb6cdcf1c
      size: 4134467
  model_training:
    cmd: python -m src.pipeline.stage_04_training
    deps:
    - path: artifacts/data_transformation
      hash: md5
      md5: 98e44a13a1f2caff40aa29164e5914e3.dir
      size: 4134411
      nfiles: 3
    - path: config/config.yaml
      hash: md5
      md5: 0291562b035d13af886220135ad47da4
      size: 1149
    - path: src/pipeline/stage_04_training.py
      hash: md5
      md5: b117c61a4c25055cf79dc27c1c855acf
      size: 1647
    params:
      config/params.yaml:
        model_trainer.collection_name: books
        model_trainer.model_name: sentence-transformers/all-MiniLM-L6-v2
    outs:
    - path: artifacts/model_trainer/vectordb
      hash: md5
      md5: 8cfb53dd9fdb09541d515570d9ec910c.dir
      size: 33450212
      nfiles: 6
  prediction:
    cmd: python -m src.pipeline.stage_05_prediction
    deps:
    - path: artifacts/data_validation/clean_books.csv
      hash: md5
      md5: 347fb6fccc65741c133914afb6cdcf1c
      size: 4134467
    - path: artifacts/model_trainer/vectordb
      hash: md5
      md5: 86474004759b54beb2b047b5cc1fcedb.dir
      size: 33450212
      nfiles: 6
    - path: src/models/hybrid_recommender.py
      hash: md5
      md5: cc0b4aa6137e5bbfd246dc17e788da1d
      size: 5590
    - path: src/pipeline/stage_05_prediction.py
      hash: md5
      md5: e98c9526eed6f88e99dcf5f75295803c
      size: 3476
    params:
      config/params.yaml:
        inference.popularity_weight: 0.2
        inference.top_k: 10
    outs:
    - path: artifacts/prediction/results.txt
      hash: md5
      md5: 93e9ce5a2e808fc15a9a4d6cf2a13a6d
      size: 6438
